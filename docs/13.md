{% include lib/mathjax.html %}
# Semidefinite programming relaxation

ในหัวข้อนี้เราจะมาดูการทำ relaxation ปัญหาการโจมตีแบบกำหนดเป้าหมายอีกวิธีหนึ่ง โดย relax ให้อยู่ในรูปของปัญหาที่เรียกว่า semidefinite programming
ซึ่งสามารถหาคำตอบได้อย่างมีประสิทธิภาพเช่นเดียวกับ linear programming 

## quadratic programming
การ relax ปัญหาให้อยู่ในรูป semidefinite programming นั้นสามารถทำได้ง่ายเมื่อปัญหาตั้งต้นจัดอยู่ในรูปของ quadratic programming ซึ่งคือปัญหา optimization
ที่ objective function และ constrain ต่างอยู่ในรูป quadratic function บนตัวแปรที่ปรับค่าได้ (ฟังก์ชันที่ดีกรีของตัวแปรไม่เกิน 2) ดังนั้นเราจะเริ่มจากการแปลงปัญหาที่เราสนใจให้อยู่ในรูปของ quadratic programming ก่อน พิจารณาปัญหาตั้งต้นของเราดังนี้

$$
\begin{array}{ll}
\max_{z_1,\dots,z_{d+1}}& (e_{y'}-e_y)^Tz_{d+1}\\
\text{subject to}&\\
&\|z_1-x\|_\infty\leq\epsilon\\
&z_{i+1} = \max(0, W_iz_i+b_i), \text{ for } i=1,\dots, d-1\\
&z_{d+1}=W_dz_d+b_d
\end{array}
$$

ตอนที่เราแปลงปัญหานี้ให้อยู่ในรูป linear integer programming สังเกตว่าปัญหาใหม่ของเราจะมีจำนวนเงื่อนไขเพิ่มขึ้นค่อนข้างมาก
เนื่องจากแต่ละเงื่อนไขถูกบังคับให้อยู่ในรูปของ linear constrain เท่านั้น แต่ตอนนี้เราสามารถออกแบบเงื่อนไขในรูปของ quadratic constrain ได้
ซึ่งจะทำให้การแปลงปัญหาเป็น quadratic programming นั้นลดจำนวนเงื่อนไขลงจาก linear integer programming ได้

เพื่อความง่าย เรามาลองพิจารณาแบบจำลอง deep learning ที่มี hidden layer จำนวน 1 layer กันดูก่อน ซึ่งปัญหาตั้งต้นเขียนได้ใหม่ดังนี้

$$
\begin{array}{ll}
\max_{z_1,z_2,z_3}& (e_{y'}-e_y)^Tz_3\\
\text{subject to}&\\
&\|z_1-x\|_\infty\leq\epsilon\\
&z_2 = \max(0, W_1z_1+b_1)\\
&z_3=W_2z_2+b_2
\end{array}
$$

{% include lib/mathjax.html %}
# Linear programming relaxation

ในหัวข้อนี้เราจะมาดูตัวอย่างการ relax ปัญหาการโจมตีแบบกำหนดเป้าหมายให้อยู่ในรูปของ linear program ซึ่งเป็นปัญหา optimization ที่มี objective function เป็น linear function บนตัวแปรที่ปรับค่าได้ และเงื่อนไขทั้งหมดก็อยู่ในรูป linear inequality บนตัวแปรที่ปรับค่าได้เช่นกัน
ในปัจจุบันเรามีอัลกอริทึมสำหรับแก้ปัญหาที่เป็น linear program ได้อย่างมีประสิทธิภาพ ตัวอย่างอัลกอริทึมดังกล่าวเช่น ellipsoid algorithm หรือ interior-point algorithms

เพื่อความสะดวก เราจะแสดง constrained formulation ของปัญหาที่เราสนใจใหม่ดังนี้

$$
\begin{array}{ll}
\max_{z_1,\dots,z_{d+1}}& (e_{y'}-e_y)^Tz_{d+1}\\
\text{subject to}&\\
&\|z_1-x\|_\infty\leq\epsilon\\
&z_{i+1} = \max(0, W_iz_i+b_i), \text{ for } i=1,\dots, d-1\\
&z_{d+1}=W_dz_d+b_d
\end{array}
$$

จาก formulation ของปัญหา จะเห็นว่าเงื่อนไขที่ยังไม่เป็น linear constrain ได้แก่สองเงื่อนไขแรก โดยที่เงื่อนไข $$\|z_1-x\|_\infty\leq\epsilon$$ นั้นสามารถแปลงให้อยู่ในรูปของ linear constrain ได้ไม่ยาก โดยการแบ่งเป็นสองเงื่อนไขใหม่ดังนี้

$$
z_1\leq x+\epsilon\\
z_1\geq x-\epsilon
$$

สำหรับเงื่อนไข $$z_{i+1}=\max(0,W_iz_i+b_i)$$ เราจะเริ่มจากการแปลงให้เป็นชุดของเงื่อนไขที่เป็น linear constrain และ binary integer constrain ก่อน จากนั้นจึงค่อยพิจารณาการ relax integer constrain ให้กลายเป็น linear constrain ทั้งหมดภายหลัง สมมติว่าเราทราบว่าค่าของ $$W_iz_i+b_i$$ นั้นจะมีค่าไม่น้อยกว่า $$l_i$$ และไม่มากกว่า $$u_i$$ เราสามารถแทนเงื่อนไข $$z_{i+1}=\max(0,W_iz_i+b_i)$$ ด้วยชุดของเงื่อนไขต่อไปนี้ได้ โดยที่ $$v_i$$ เป็นตัวแปรที่มีค่าเป็น 0 หรือ 1 ได้เท่านั้น

$$
\begin{split}
z_{i+1}&\geq&W_iz_i+b_i\\
z_{i+1}&\geq&0\\
u_i\cdot v_i&\geq&z_{i+1}\\
W_iz_i+b_i&\geq&z_{i+1}+(1-v_i)l_i\\
v_i&\in&\{0,1\}^{|v_i|}
\end{split}
$$

เพื่อทำความเข้าใจชุดเงื่อนไขเหล่านี้ เราจะแยกการวิเคราะห์ออกเป็นสองกรณีโดยสมมติว่าตัวแปรเหล่านี้เป็นสเกลาร์ทั้งหมดเพื่อความสะดวก

กรณีแรก พิจารณาเมื่อ $$W_iz_i+b_i> 0$$ สังเกตว่าถ้าเรากำหนดให้ $$v_i=0$$ เงื่อนไขที่สามแสดงว่า $$z_{i+1}\leq 0$$

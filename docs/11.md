{% include lib/mathjax.html %}
# การสร้าง robustness certificate

หลังจากที่เราได้รู้จักการสร้าง adversarial example เพื่อใช้ในการโจมตีแบบจำลองทาง machine learning และการทำ adversarial training เพื่อเพิ่มความทนทานให้แก่แบบจำลองแล้ว ในหัวข้อนี้เราจะมาสนใจเกี่ยวกับการทดสอบความทนทานของแบบจำลองเมื่อเราพิจารณาที่จุด sample $$x$$ ใด ๆ กล่าวคือ เราอยากทราบว่าหาก sample $$x$$ ของเราถูกก่อกวนด้วยการก่อกวน $$\delta$$ ใด ๆ ในขอบเขต $$\|\delta\|_\infty\leq\epsilon$$ จะมีโอกาสที่แบบจำลองของเราเปลี่ยนผลการทำนายไปจากเดิมหรือไม่ หากเราสามารถรับประกันได้ว่าภายในขอบเขตการก่อกวนดังกล่าว ไม่มีการก่อกวนใด ๆ สามารถทำให้แบบจำลองของเราทำนายผิดไปจากเดิมได้เลย แสดงว่าแบบจำลองของเราได้รับการยืนยันแล้วว่ามีความทนทานต่อการก่อกวนภายในระยะห่าง $$\epsilon$$ ที่จุด $$x$$ แน่นอน เราอาจเรียกการยืนยันดังกล่าวว่าเป็น robustness certificate 

## constrained formulation ของการโจมตีแบบกำหนดเป้าหมาย

เพื่อสร้าง robustness certificate เราจะเริ่มจากการกลับมามองปัญหา maximization สำหรับการสร้าง adversarial example ใหม่ 
พิจารณาการคำนวณของแบบจำลอง deep ReLU network $$d$$ layer ของเราบน sample $$x$$ ดังนี้

$$
\begin{split}
z_1&=&x\\
z_{i+1}&=&f_i(W_iz_i+b_i), \text{ for } i=1,\dots,d\\
h_\theta(x)&=&z_{d+1}
\end{split}
$$

โดย $$f_i(z)=\text{ReLU}(z)=\max(0, z)$$ สำหรับ $$i=1,\dots,d-1$$ และ $$f_d(z)=z$$ 

เมื่อเราได้ $$h_\theta(x)$$ มาเป็นเวกเตอร์ที่มีมิติเท่ากับจำนวนคลาสผลลัพธ์ แบบจำลองของเราก็จะเลือกตอบคลาส $$y$$ ที่มีค่า $$h_\theta(x)_y$$ มากที่สุด

จากตรงนี้จะเห็นว่า เราสามารถมองปัญหาการโจมตีแบบกำหนดเป้าหมายที่ sample $$(x, y)$$ เป็นการพยายามหา sample $$x^{adv}$$ ที่มีระยะห่างจาก $$x$$ ไม่เกิน $$\epsilon$$ ที่เวกเตอร์ $$h_\theta(x^{adv})$$ มีค่าในมิติของคลาสเป้าหมาย $$y'$$ เอาชนะมิติของคลาส $$y$$ ให้ได้สูงที่สุด นั่นคือ เราต้องการ maximize $$(h_\theta(x^{adv})_{y'} - h_\theta(x^{adv})_y)$$ นั่นเอง

ดังนั้น ถ้าเรากำหนดให้ $$e_i$$ เป็นเวกเตอร์ความยาวเท่ากับจำนวนคลาสผลลัพธ์ ที่มีค่าเป็น 1 ในมิติที่ $$i$$ และมิติที่เหลือมีค่าเป็น 0 ทั้งหมด
เราจะสามารถเขียนปัญหาการโจมตีแบบกำหนดเป้าหมายในลักษณะของ constrained formulation ได้ดังนี้

$$
\begin{array}{l}
\max_{z_1,\dots,z_{d+1}} (e_{y'}-e_y)^Tz_{d+1}\\
\text{subject to}\\
\quad \|z_1-x\|_\infty\leq\epsilon\\
\quad z_{i+1} = \max(0, W_iz_i+b_i), \text{ for } i=1,\dots, d-1\\
\quad z_{d+1}=W_dz_d+b_d
\end{array}
$$
